<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button defaultHref="/productos"></ion-back-button>
        </ion-buttons>
        <ion-title>Mi Perfil</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content>
    @if (cargando()) {
    <div class="loading-container">
        <ion-spinner></ion-spinner>
    </div>
    } @else if (usuario()) {
    <div class="perfil-container">
        <!-- Avatar y nombre -->
        <div class="perfil-header">
            <div class="avatar">
                <ion-icon name="person-circle-outline" size="large"></ion-icon>
            </div>
            <h2>{{ usuario()?.username || 'Usuario' }}</h2>
            <p class="perfil-tipo">{{ usuario()?.perfil || 'Cliente' }}</p>
        </div>

        <!-- Opciones del perfil -->
        <ion-list>
            <ion-list-header>
                <ion-label>Cuenta</ion-label>
            </ion-list-header>

            <ion-item button (click)="irAEditarPerfil()">
                <ion-icon slot="start" name="person-outline"></ion-icon>
                <ion-label>
                    <h3>Editar Perfil</h3>
                    <p>Actualizar información personal</p>
                </ion-label>
                <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
            </ion-item>

            <ion-item button (click)="irACambiarPassword()">
                <ion-icon slot="start" name="lock-closed-outline"></ion-icon>
                <ion-label>
                    <h3>Cambiar Contraseña</h3>
                    <p>Actualizar tu contraseña</p>
                </ion-label>
                <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
            </ion-item>

            <ion-list-header>
                <ion-label>Mis Compras</ion-label>
            </ion-list-header>

            <ion-item button (click)="irAHistorialCompras()">
                <ion-icon slot="start" name="receipt-outline"></ion-icon>
                <ion-label>
                    <h3>Historial de Compras</h3>
                    <p>Ver todas tus compras</p>
                </ion-label>
                <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
            </ion-item>

            <ion-list-header>
                <ion-label>Sesión</ion-label>
            </ion-list-header>

            <ion-item button (click)="cerrarSesion()" detail="false">
                <ion-icon slot="start" name="log-out-outline" color="danger"></ion-icon>
                <ion-label color="danger">
                    <h3>Cerrar Sesión</h3>
                </ion-label>
            </ion-item>
        </ion-list>
    </div>
    }
</ion-content>